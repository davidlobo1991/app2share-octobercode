<form action="" method="post" id="payment-form">
    <div class="form-group">
        <div class="form-row">
            <div id='calendar' style="width: 330px; padding: 30px;"></div>

            <input type="hidden" name="amount" id="form_amount" />
            <input type="hidden" name="start_date" id="form_start_date" />
            <input type="hidden" name="start_end" id="form_end_date" />

            <ul style="display: none;">
                {% for offer in obOffer %}
                    <li>
                        <input type="radio" id="days-{{ offer.name }}" class="pack-products" name="code"
                               value="{{ offer.code }}">
                        <label for="days-{{ offer.name }}"></label><br>
                    </li>
                {% endfor %}
            </ul>

            <span id="days-price"></span>

            <div id="card-element" style="width: 100%;">
                <!-- a Stripe Element will be inserted here. -->
            </div>

            <div id="card-errors" role="alert"></div>
        </div>
    </div>
    <button class="btn btn-primary" type="submit" data-attach-loading>Pay with card</button>

    <div id="paypal-pack-container"></div>

</form>

<script src="https://www.paypal.com/sdk/js?client-id=AWQ8g3KD0UCOYmnAIKmCbyywIvxBayYy_2C7qgxKrdR1tHZIeBJ_jv8mn_t_dKxKMyyqaVErKPPvNT62"
        data-sdk-integration-source="button-factory"></script>

<script>
    // PAYPAL BUTTON PACK
    paypal.Buttons({
        style: {
            shape: 'rect',
            color: 'blue',
            layout: 'vertical',
            label: 'checkout',

        },
        createOrder: function(data, actions) {
            let amount = document.getElementById('form_amount').value;
            let formStartDate = document.getElementById('form_start_date').value;
            let formEndDate = document.getElementById('form_end_date').value;

            let floatAmount = parseFloat(amount);

            $.ajax({
                url: "payment/paypal",
                data: {'actions': actions, 'amount': amount, 'formStartDate': formStartDate, 'formEndDate': formEndDate},
                method: 'post',
                success: function(data){
                    alert(data);
                }
            });

            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: floatAmount
                    },
                    no_shipping: 1
                }]
            });
        },
        onApprove: function(data, actions) {
            console.log(data);
            console.log(actions);

            $.ajax({
                url: "payment/approve",
                method: 'post',
                data: {'actions': actions, 'data': data},
                success: function(){
                    alert('vamos');
                }
            });

        }
    }).render('#paypal-pack-container');
</script>
